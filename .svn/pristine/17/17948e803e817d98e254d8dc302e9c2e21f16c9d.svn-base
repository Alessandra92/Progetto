package persistenza.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import modello.Pdf;
import modello.Prenotazione;
import persistenza.DAOPdfInterface;
import persistenza.DataSource;

public class DAOPdf implements DAOPdfInterface {

	private static Connection connection;
	private static Statement statement;
	private static ResultSet result;
	private static PreparedStatement pr;

	
	public static Pdf getPdfByIdPaziente(int idPrenotazione){
		Pdf pdf = null;
		try{
			connection = DataSource.getConnection();
			Prenotazione prenotazione = DAOPrenotazione.getPrenotazioneById(idPrenotazione);
			String query = "select * from pdf where "
						 + "idPaziente = ? and "
						 + "idPrenotazione = ? and "
						 + "idAzienda = ? and "
						 + "idEsame = ?";
			pr = connection.prepareStatement(query);
			pr.setInt(1, prenotazione.getIdPaziente());
			pr.setInt(2, prenotazione.getIdPrenotazione());
			pr.setInt(3, prenotazione.getIdAzienda());
			pr.setInt(4, prenotazione.getIdEsame());
			result = pr.executeQuery();
			if(result.next()){
				pdf = new Pdf(result);
			}
		}catch(SQLException e){
			System.out.println(e);
		}finally{
			DataSource.closeAll(connection, statement, result, pr);
		}
		return pdf;
	}
	
}
